<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />

    <!-- App identity -->
    <title>Is This Everything?</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />

    <!--
      IMPORTANT for Vite + base="/couples-question-deck/":
      Use RELATIVE paths in index.html so dev (/) and GH Pages (/couples-question-deck/)
      both work without hardcoding the repo name here.
    -->

    <!-- Icons / manifest -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="manifest" href="/manifest.webmanifest" />

    <!-- iOS home screen / PWA -->
    <link rel="apple-touch-icon" href="/pwa-192.png" />

    <!-- Modern standard -->
    <meta name="mobile-web-app-capable" content="yes" />

    <!-- Legacy Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="apple-mobile-web-app-title" content="Is This Everything?" />

    <!-- Theme colors (system-aware baseline; JS below will update BOTH) -->
    <meta
      name="theme-color"
      content="#f6f7f9"
      media="(prefers-color-scheme: light)"
    />
    <meta
      name="theme-color"
      content="#000000"
      media="(prefers-color-scheme: dark)"
    />

    <!--
      Theme + Accent bootstrap (runs BEFORE paint, prevents flash)

      - Applies .dark based on sr-theme + system preference
      - Applies background overrides (sr-bg-light / sr-bg-dark)
      - Applies accent if stored (sr-accent) by setting:
          html[data-accent="on"] and inline --accent
      - Updates BOTH theme-color metas so iOS Safari/PWA chrome stays consistent
    -->
    <script>
      (function () {
        try {
          const root = document.documentElement;

          // ----- Keys -----
          const THEME_KEY = "sr-theme";
          const BG_LIGHT_KEY = "sr-bg-light";
          const BG_DARK_KEY = "sr-bg-dark";
          const ACCENT_KEY = "sr-accent";

          // ----- Theme mode -----
          const mode = localStorage.getItem(THEME_KEY) || "system";
          const systemDark =
            window.matchMedia &&
            window.matchMedia("(prefers-color-scheme: dark)").matches;

          const shouldDark =
            mode === "dark" || (mode === "system" && systemDark);
          root.classList.toggle("dark", shouldDark);

          // ----- Background overrides (optional) -----
          const bgLight = (localStorage.getItem(BG_LIGHT_KEY) || "").trim();
          const bgDark = (localStorage.getItem(BG_DARK_KEY) || "").trim();

          if (bgLight) root.style.setProperty("--bg-override-light", bgLight);
          else root.style.removeProperty("--bg-override-light");

          if (bgDark) root.style.setProperty("--bg-override-dark", bgDark);
          else root.style.removeProperty("--bg-override-dark");

          // Helper: update BOTH theme-color metas (Safari/PWA chrome)
          function setThemeColorMeta(color) {
            const metas = document.querySelectorAll('meta[name="theme-color"]');
            metas.forEach((m) => m.setAttribute("content", color));
          }

          // ----- Accent (optional) -----
          const accent = (localStorage.getItem(ACCENT_KEY) || "").trim();

          // Tiny validation to avoid poisoning CSS with junk
          const isHex = /^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/.test(accent);

          if (isHex) {
            root.style.setProperty("--accent", accent);
            root.setAttribute("data-accent", "on");

            // Tint the browser chrome/status bar area to match accent
            setThemeColorMeta(accent);
          } else {
            root.style.removeProperty("--accent");
            root.removeAttribute("data-accent");

            // Fall back to baseline theme colors
            setThemeColorMeta(shouldDark ? "#000000" : "#f6f7f9");
          }
        } catch (e) {
          // Prefer loading over perfect theming
        }
      })();
    </script>
    <script type="module" crossorigin src="/assets/index-DFlhVtXJ.js"></script>
    <link rel="stylesheet" crossorigin href="/assets/index-ZQSYnuj4.css">
  <link rel="manifest" href="/manifest.webmanifest"><script id="vite-plugin-pwa:register-sw" src="/registerSW.js"></script></head>

  <body>
    <div id="root"></div>

    <!-- Vite entry: keep relative so Vite base handles GH Pages automatically -->
  </body>
</html>